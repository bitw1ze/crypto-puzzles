#!/usr/bin/env python3.2

import sys

from myrsa import rsa_decrypt_num
from helpers import *
from mymath import invmod

C = 0x9A6497E78CB6F9BF04015F85C0B4147D8813D46F712E941104BA4FC000D4ADF8FD615268AE445355B8ED8AEA34F845A96C39987725E582863289AF415E9A3DC729D2D9E2AE4B654F7552430151214F03E6FA3A795CAD1120BFB2E4BD260323E4341B26C664C3C4C35EEB1E7A1ABDD86B0028AD7A2AD1C2FCA7ACBC10E40C4E58DE30C85C738FFD0ABF78338F33D6481D029E163A4763F1A076F5688FD7161E61FC68E27159E0AF245273F59C770BF9FE1BF13030A792F7535569BE6853EC76ABD63D249B1261E9F5702C2306F90F7D06E78944FD4BFCB9C4F765F41D6047606305A98D85CD5C2D32EBA6601AA58B2142D05CAE05A7B1285EEA3886FCD703B3E4
N = 0xAE6D4FFCF9E67C9F8AA30694F03E0EB8B512E2E1C311A32F3F54E69B3C965F8EABF55D08857E1FD545750230731A0E39D6F138CE40557AEAFCD11F5DD0531813E29741E905D46AB404D93113B34792DCB72479186656912DC88F0F219F4A925457591AF23B243340FA86AD16E5F78840A561396D9A335D1BE6F01F62963D6C5E35A4EACB348605D05779EF9886A2809184024ED7892D5C6492A186DA95D814E8D9AAC64369EF7FC5B55707A675DFF71D2EBB088BCF6736719268059A4FC4D00C082087065C999881ED27CAC2B219DA5A6E677DC076BCBB9675F85B553E3FB76B19720FF086444487B6B64FFC61CECA7E89181344EBA866AEF45C74519AC1A609
E = 0xFFFF
D = 0x1CFD6FE4AF3D29BB7DBA0DF616D3A72E01E621733EEAD155CF905FD3F4A9C2936CCFB841FED1B104170B45646AC5A35AE840077CEED623BFE9BC7B3F06BA961F042BBFB406180FC3F3023BD64E0617429E02C1D2FBF5271E0F0F35C7004C5916358A98B112DD5B120BB525C19001EFBB0E3772CED60B9769168EC7061D965AF4CCE77153496060B85DD02A3A344DD63BBADE9D5648F8887397A7FC8FC4EA7E9009E48EC3E38DAE8DB06DB7E6067AF1C4DCE12CA67027966FA9C81175B15EE2B06BA076D1196B5F1781FB0400D88C6848A15B824C557456BFD17F31356697F2E15E854C61D8A074DAD2DCBA8093BC79D879DBA845BFFCD7D4AA01C7CD432B863F


def submit(ciphertext):

    privkey = (D, N)
    return rsa_decrypt_num(privkey, ciphertext)


def main():

    import os
    from Crypto.PublicKey.pubkey import getStrongPrime
    S = getStrongPrime(512) % N
    C1 = (pow(S, E, N) * C) % N

    P1 = submit(C1)
    P = (P1 * invmod(S, N)) % N
    print(i2s(P))

if __name__ == '__main__':
    sys.exit(main())
